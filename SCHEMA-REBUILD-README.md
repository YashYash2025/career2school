# ๐ ุฏููู ุฅุนุงุฏุฉ ุจูุงุก Schema - ุณุฑูุน

## โก ุงูุชูููุฐ ุงูุณุฑูุน (5 ุฏูุงุฆู)

### ุงูุฎุทูุฉ 1: ุงูุชุญ Supabase Dashboard
```
https://imobhmzywvzbvyqpzcau.supabase.co/project/_/sql
```

### ุงูุฎุทูุฉ 2: ุงูุณุฎ ูุงูุตู
1. ุงูุชุญ ููู `rebuild-schema.sql`
2. ุงูุณุฎ ุงููุญุชูู ูุงููุงู (Ctrl+A, Ctrl+C)
3. ุงูุตูู ูู SQL Editor
4. ุงุถุบุท **RUN** ุฃู **F5**

### ุงูุฎุทูุฉ 3: ุชุญูู ูู ุงููุฌุงุญ
```bash
node verify-schema.js
```

---

## ๐ ุงููููุงุช ุงููููุฉ

| ุงูููู | ุงููุตู |
|------|-------|
| `rebuild-schema.sql` | โญ ุงูููู ุงูุฑุฆูุณู ููุชูููุฐ |
| `verify-schema.js` | ุงูุชุญูู ูู ุงููุฌุงุญ |
| `SCHEMA-CHANGES.md` | ุงูุชูุซูู ุงููุงูู |
| `check-database-data.js` | ูุญุต ุงูุจูุงูุงุช |
| `clear-database-tables.js` | ุชูุฑูุบ ุงูุฌุฏุงูู |

---

## โ ูุงุฐุง ููุนู rebuild-schema.sqlุ

### 1. ุญุฐู ุงูุฌุฏุงูู ุงููุฏููุฉ โ
- `users` (ููุฑุฑ)
- `user_assessments` (ููุฑุฑ)
- `assessment_progress` (ููุฑุฑ)

### 2. ุฅูุดุงุก ุงูุฌุฏุงูู ุงููุญุณููุฉ โ
- `user_profiles` (ูุญุณูู)
- `user_credits` (ุฌุฏูุฏ)
- `assessment_sessions` (ูุญุณูู)
- ูุจุงูู ุงูุฌุฏุงูู...

### 3. ุฅุถุงูุฉ Triggers โ
- ุชุญุฏูุซ `full_name` ุชููุงุฆูุงู
- ุชุญุฏูุซ `updated_at` ุชููุงุฆูุงู

### 4. ุฅุถุงูุฉ Indexes โ
- ุชุญุณูู ุงูุฃุฏุงุก
- ุชุณุฑูุน ุงูุงุณุชุนูุงูุงุช

### 5. ุฅูุดุงุก Views โ
- `user_summary` - ููุฎุต ุงููุณุชุฎุฏู

---

## ๐ฏ ุงูุชุญุณููุงุช ุงูุฑุฆูุณูุฉ

### ูุจู โ
```
auth.users โ public.users โ public.user_profiles
```
- 3 ุฌุฏุงูู
- ุชูุฑุงุฑ ูู ุงูุจูุงูุงุช
- ุนูุงูุงุช ูุนูุฏุฉ

### ุจุนุฏ โ
```
auth.users โ public.user_profiles
```
- ุฌุฏูููู ููุท
- ูุง ุชูุฑุงุฑ
- ุนูุงูุงุช ูุงุถุญุฉ

---

## ๐ ุงูุชุญูู ูู ุงููุฌุงุญ

### ูุฌุจ ุฃู ุชุฑู:
```
โ user_profiles: ููุฌูุฏ
โ user_credits: ููุฌูุฏ (ุฌุฏูุฏ)
โ assessment_sessions: ููุฌูุฏ
โ assessment_results: ููุฌูุฏ
โ career_recommendations: ููุฌูุฏ
... ูุจุงูู ุงูุฌุฏุงูู
```

### ุงูุจูุงูุงุช ุงููุฑุฌุนูุฉ ูุญููุธุฉ:
```
โ countries: 79 ุตู
โ governorates: 55 ุตู
โ education_levels: 4 ุตู
โ education_grades: 12 ุตู
```

---

## โ๏ธ ูู ุญุงูุฉ ูุฌูุฏ ูุดุงูู

### ุงููุดููุฉ: "relation already exists"
**ุงูุญู:** ุงูุฌุฏูู ููุฌูุฏ ุจุงููุนูุ ุชุฌุงูู ุงูุฎุทุฃ ุฃู ุงุญุฐูู ูุฏููุงู

### ุงููุดููุฉ: "permission denied"
**ุงูุญู:** ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู Service Role Key

### ุงููุดููุฉ: "syntax error"
**ุงูุญู:** ุชุฃูุฏ ูู ูุณุฎ ุงูููู ูุงููุงู

---

## ๐ ุงูุฏุนู

### ุงูุฃูุงูุฑ ุงููููุฏุฉ:
```bash
# ูุญุต ุงูุจูุงูุงุช ุงูุญุงููุฉ
node check-database-data.js

# ุชูุฑูุบ ุงูุฌุฏุงูู
node clear-database-tables.js

# ุงูุชุญูู ูู Schema
node verify-schema.js
```

---

## ๐ ุจุนุฏ ุงููุฌุงุญ

### ุงูุฎุทูุงุช ุงูุชุงููุฉ:
1. โ ููุก `assessment_tools` ุจุงูุฃุฏูุงุช ุงูู14
2. โ ููุก `assessment_packages` ุจุงูุญุฒู ุงูู6
3. โ ููุก `assessment_questions` ุจุงูุฃุณุฆูุฉ
4. โ ุชุญุฏูุซ ููุฏ ุงูุชุทุจูู
5. โ ุงุฎุชุจุงุฑ ุงูุชุณุฌูู ูุงูุชููููุงุช

---

**ููุช ุงูุชูููุฐ:** 2-5 ุฏูุงุฆู  
**ุงูุตุนูุจุฉ:** ุณูู โญ  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ
